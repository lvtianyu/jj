var controller=(function(j,k,l){var m,d,g=[],n=j("#backgroundFefresh"),o=j("#result-list");function c(){m=locache.session.get("dress-s_id")||oGetVars.s_id}function i(){j.ajax({type:"get",url:nodeurl+"game/getShopRecord.do",data:{s_id:m},dataType:dataType,beforeSend:function(p){n.show()},success:function(p){n.hide();if(p.result=="ok"){var r=p.values;return b(r)}else{var q=p.errormsg;return noticeSetTimeoutPublick(q)}},error:function(){n.hide()}})}function b(H){console.log(H);var B="",x,G,r,u,w,p,y,E,s,F,t,z,v,q,A,C={},D=H.length-1;if(D>-1){do{s=H[D];x=s.a;G=s.b;r=x.head_portrait;u=G.head_portrait;y=x.num;E=G.num;w=x.nickname;p=G.nickname;q=s.level;v=D+1;z=H[D].g_id;switch(q){case 0:t="vs_style0";A="70公斤以下级别";break;case 1:t="vs_style1";A="70~85公斤级别";break;case 2:t="vs_style2";A="85公斤以上级别";break;case 3:t="vs_style3";A="女子级别";break}B+="<li id="+z+'><div class="vs-style '+t+'"><ul><li class="frist-people"><div class="head-img"><div><img src='+r+' alt="tou"></div></div><div class="nick-name">'+w+'</div><div class="support-num">'+y+'</div></li><li class="second-people"><div class="head-img"><div id="second-head-img"><img src='+u+' alt="tou"></div></div><div class="nick-name" id="second-nick-name">'+p+'</div><div class="support-num" >'+E+'</div></li></ul><div class="record-mark"><div class="level-mark">'+A+'</div><div class="screening-mark">第<div>'+v+'</div>场</div><div class="make-win"><img src="../source/img/victory@2x.png" ></div></div></div><div class="list-show-view hidden-style"><div class="title-support" >支持<span>'+w+'</span>人数</div><ul class="list-ul"></ul></div></li>';C[z]={g_id:z,g_a:x.u_id,g_b:G.u_id};console.log(C,v)}while(--D>=0);g=C}else{B='<li class="notice-none">暂无记录!</li>'}o.append(B);return f()}function f(){j("#result-list>li").on("click",function(){var r=j(this),p=r.attr("id"),q;j(".active").hide().removeClass("active");if(d!=p){q=g[p];d=p;e(q,r)}else{d=""}})}function e(q,p){j.ajax({type:"get",url:nodeurl+"game/getThumbUpSum.do",data:q,dataType:dataType,beforeSend:function(r){n.show()},success:function(r){n.hide();if(r.result=="ok"){var t=r.values.list;return a(t,p)}else{var s=r.errorcode;return noticeSetTimeoutPublick(s)}},error:function(){n.hide()}})}function a(t,w){var v="",q,s,x,y,p,u,r=t.length-1;if(r>-1){do{u=t[r];q=u.head_portrait||"../source/img/img-defaule-head.png";y=u.nickname||"无名氏";p=u.fee;v+='<li><div class="head-img-spectator"><img src='+q+' alt=""></div><ul><li class="nick-name-spectator">'+y+'</li><li class="support-money"> '+p+"元</li></ul></li>"}while(--r>=0)}else{v+='<li class="notice-none">暂无支持者!</li>'}w.find(".list-ul").html(v);w.find(".list-show-view").show().addClass("active")}var h=function(){c();i()};return{doInit:h}})(Zepto,window,document);$(function(){controller.doInit()});