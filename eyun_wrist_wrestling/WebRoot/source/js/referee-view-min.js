var controller=(function(x,C,e){var g=x("#show-kilo-list"),z=x("#choose-btn"),F=x("#start-game"),n=x("#back-game-open"),b=x("#ok-open"),m=x("win-btn"),l=false,r,h=null,I,H=true,s={},A={},i,c=e.getElementById("make-win"),a=e.getElementById("win-btn"),G=x("#game-over"),u=x("#ok"),o=x("#back-game"),B=x("#backgroundFefresh"),v=x("#game-open"),J;var w=(function(){var M=navigator.userAgent,N=navigator.appVersion;if(M.indexOf("Mobile")>-1){}else{if(M.indexOf("iPad")>-1){}else{H=false}}})();function p(){var M=locache.session.get("refereeViewInfor");s=M.a;A=M.b;if(M){D(M)}else{f()}J=oGetVars.g_id||locache.session.get("g_id")}function f(){var N={g_id:J},M="game/getCompetitorsInfo.do",O=new PublickFn(M,N,D);O.ajaxFn();O=null}function d(M){x("#second-support-num").html(M.b);x("#frist-support-num").html(M.a);F.off();l=true}function k(){if(!s.u_id&&!A.u_id&&!J){return noticeSetTimeoutPublick("后台或者前台出现问题")}var N={a:s.u_id,b:A.u_id,g_id:J},M="game/beginTheGame.do",O=new PublickFn(M,N,d);O.ajaxFn();O=null}function D(Q){var O=Q.a,N=Q.b,M=O.head_portrait,P=N.head_portrait;x("#frist-head-img").attr("src",M);x("#frist-nick-name").html(O.nickname);x("#second-head-img").attr("src",P);x("#second-nick-name").html(N.nickname);s.u_id=O.u_id;A.u_id=N.u_id}touch.on(".vs-style","touchstart",function(M){M.preventDefault()});e.addEventListener("touchmove",function(M){M.preventDefault()},false);if(H){touch.on("#win-btn","touchstart",function(M){r=M.touches[0].clientX;t()});touch.on("#win-btn","touchmove",function(N){var M=N.touches[0].clientX;y(M)})}else{a.onmouseenter=function(M){r=M.clientX;t()};a.onmousemove=function(N){var M=N.clientX;y(M)}}function t(){I=true}var y=function(M){if(I){if(l){if(M>r){c.setAttribute("style","text-align:right");i=2;G.show()}else{if(M<r){c.setAttribute("style","text-align:left");i=1;G.show()}}I=false;r=M}else{var N="请先开始游戏!";return noticeSetTimeoutPublick(N)}}};u.on("click",E);o.on("click",function(){G.hide();c.setAttribute("style","text-align:center")});function E(){G.hide();var M={g_id:J,level:h};if(i===1){M.winner=s.u_id;M.g_b=A.u_id}else{M.winner=A.u_id;M.g_b=s.u_id}return q(M)}function j(){var M="referee-get-participant.html";locationSelf.href=M}function q(O){if(!O.winner&&!O.g_b){return noticeSetTimeoutPublick("后台或者前台出现问题")}var N="game/decideTheWinner.do",M=new PublickFn(N,O,j);M.ajaxFn();M=null}z.on("click",function(){g.removeClass("hidden-style")});x("#show-kilo-list>ul>li").on("click",function(){var N,M=x(this),O=M.attr("id");g.addClass("hidden-style");x(".active").removeClass("active");M.addClass("active");N=M.html();z.html(N);h=O});F.on("click",function(){v.show()});b.on("click",function(){v.hide();if(!h){return noticeSetTimeoutPublick("请你先选择体重级别,才能开始比赛")}k()});n.on("click",function(){v.hide()});function L(M){locationSelf.replace(M)}var K=function(){p()};return{doInit:K}})(Zepto,window,document);$(function(){controller.doInit()});