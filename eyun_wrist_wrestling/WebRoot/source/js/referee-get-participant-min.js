var controller=(function(d,g,m){var f=d("#record-page-btn"),k=d("#QR-code-rgp"),i,l,c=d("#game-over"),q=d("#back-game"),h=d("#ok"),j=d("#cancel-game"),v=d("#backgroundFefresh"),n=false,e;function w(){var x=locache.session.get("s_id");e=oGetVars.s_id||x;l=oGetVars.g_id;if(e!=x){locache.session.set("s_id",e)}if(l){return s(l)}else{return u()}}function u(){d.ajax({type:"get",url:nodeurl+"game/generateCompetitionQrCode.do",data:{s_id:e},dataType:dataType,beforeSend:function(x){v.show()},success:function(x){v.hide();if(x.result=="ok"){l=x.values;return s(l)}else{var y=x.errormsg;return noticeSetTimeoutPublick(y)}},error:function(){v.hide()}})}function r(){console.log(l);if(!l){return}d.ajax({type:"get",url:nodeurl+"game/getCompetitorsInfo.do",data:{g_id:l},dataType:dataType,beforeSend:function(x){},success:function(x){if(x.result=="ok"){n=true;var z=x.values;locache.session.set("refereeViewInfor",z);d("#firstName").html(z.a.nickname);d("#secondName").html(z.b.nickname);c.show()}else{var y=x.errormsg;noticeSetTimeoutPublick(y)}},complete:function(x){},error:function(){}})}function o(){var x=setTimeout(function(){if(n){clearTimeout(x)}else{r()}},10000)}function s(x){var y=nodeurl+"pages/participant-view.html?gameId="+x+"="+e;k.qrcode({width:160,height:160,text:y});return o()}f.on("click",function(){var x="record-page.html";locationSelf.href=x+"?s_id="+e});function t(){c.hide();var y={s_id:e,g_id:l},x="game/cancelTheGame.do",z=new PublickFn(x,y,a);z.ajaxFn();z=null}function a(x){l=x.g_id;console.log(l);d("canvas").remove();s(l)}d("#to-referee-btn").on("click",function(){console.log(1);return r()});q.on("click",function(){c.hide()});h.on("click",function(){c.hide();if(n){var x="referee-view.html";return b(x)}});j.on("click",function(){t()});function b(y){var x=y+"?g_id="+l;locationSelf.replace(x)}var p=function(){w()};return{doInit:p}})(Zepto,window,document);$(function(){controller.doInit()});