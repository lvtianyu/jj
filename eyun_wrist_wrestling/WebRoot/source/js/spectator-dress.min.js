var controller=function(i,e,t){function o(){var e=locationSelf.href;i.ajax({type:"get",url:nodeurl+"wechat/initJSSDK.do",data:{pageUrl:e},dataType:dataType,beforeSend:function(i){},success:function(i){if("ok"==i.result){var e=i.values,t=e.appid,o=e.timestamp,n=e.noncestr,s=e.signature;void 0!=wx&&(wx.config({debug:!1,appId:t,timestamp:o,nonceStr:n,signature:s,jsApiList:["getLocation","openLocation"]}),l.show())}else alert(i.errormsg)},error:function(){alert("error")},complete:function(i,e){}})}function n(i,e){var t={longitude:i,latitude:e,u_id:u_id},o="shop/getShopList.do",n=new PublickFn(o,t,s);n.ajaxFn(),n=null}function s(e){var t,o,n,s,r,c,d,u,f="",p=e.length-1;if(p>-1){do u=e[p],t=u.s_url||"../source/img/shop-back.png",o=u.s_name,n=u.s_address||"无",s=u.s_id,r=u.activity,d=u.s_distance||0,c=1==r?"活动进行中":"没有活动",f+='<li class="list-li-border-bottom" id='+s+"><div ><img src="+t+' alt="" id="shop-img"></div><ul><li><div class="shop-name">'+o+'</div><div class="shop-position">'+d+'米</div></li><li> <div class="ctivity-content">'+n+'</div><div class="is-shop"><span class="activity">'+c+"</span></div></li></ul></li>";while(--p>=0)}else f='<li class="notice-none">暂无店铺!</li>';return i("#list-shop-show").html(f),l.hide(),a()}function a(){i("#list-shop-show>li").on("click",function(){c=i(this).attr("id"),r(c)})}function r(e){e&&i.ajax({type:"get",url:nodeurl+"game/getGameInfoBySid.do",data:{s_id:e},dataType:dataType,beforeSend:function(i){l.show()},success:function(t){if(l.hide(),"ok"==t.result){var o="spectator.html?s_id="+e,n=t.values;locache.session.set("getGameInfoBySid",n),locache.session.set("dress-s_id",e),locationSelf.href=o}else{var s=t.errormsg;if(noticeSetTimeoutPublick(s),"000022"==t.errorcode){var a="#"+e;i(a).find(".activity").html("没有活动"),locationSelf.href="shop-info-msg.html?s_id="+e}}},complete:function(i){},error:function(){l.hide()}})}var c,l=(i("#record-page-btn"),i("#QR-code-rgp"),i("#backgroundFefresh")),d=i("#logo-win");wx.ready(function(){wx.getLocation({type:"wgs84",success:function(i){return n(i.longitude,i.latitude)}})}),d.on("click",function(){locationSelf.href="company-QR.html"}),wx.error(function(i){alert("微信接口出现错误: "+i.errMsg)});var u=function(){o()};return{doInit:u}}(Zepto,window,document);$(function(){controller.doInit()});