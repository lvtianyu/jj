var controller=function(n,t,e){function i(){var n=locache.session.get("refereeViewInfor");P=n.a,F=n.b,n?a(n):o(),g=oGetVars.g_id||locache.session.get("g_id")}function o(){var n={g_id:g},t="game/getCompetitorsInfo.do",e=new PublickFn(t,n,a);e.ajaxFn(),e=null}function c(t){n("#second-support-num").html(t.b),n("#frist-support-num").html(t.a),k.off(),p=!0}function u(){if(!P.u_id&&!F.u_id&&!g)return noticeSetTimeoutPublick("后台或者前台出现问题");var n={a:P.u_id,b:F.u_id,g_id:g},t="game/beginTheGame.do",e=new PublickFn(t,n,c);e.ajaxFn(),e=null}function a(t){var e=t.a,i=t.b,o=e.head_portrait,c=i.head_portrait;n("#frist-head-img").attr("src",o),n("#frist-nick-name").html(e.nickname),n("#second-head-img").attr("src",c),n("#second-nick-name").html(i.nickname),P.u_id=e.u_id,F.u_id=i.u_id}function r(){h=!0}function l(){C.hide();var n={g_id:g,level:x};return 1===m?(n.winner=P.u_id,n.g_b=F.u_id):(n.winner=F.u_id,n.g_b=P.u_id),d(n)}function s(){var n="referee-get-participant.html";locationSelf.href=n}function d(n){if(!n.winner&&!n.g_b)return noticeSetTimeoutPublick("后台或者前台出现问题");var t="game/decideTheWinner.do",e=new PublickFn(t,n,s);e.ajaxFn(),e=null}var f,h,m,g,v=n("#show-kilo-list"),b=n("#choose-btn"),k=n("#start-game"),_=n("#back-game-open"),w=n("#ok-open"),p=(n("win-btn"),!1),x=null,y=!0,P={},F={},I=e.getElementById("make-win"),T=e.getElementById("win-btn"),C=n("#game-over"),S=n("#ok"),A=n("#back-game"),X=(n("#backgroundFefresh"),n("#game-open"));(function(){var n=navigator.userAgent;navigator.appVersion;n.indexOf("Mobile")>-1||n.indexOf("iPad")>-1||(y=!1)})();touch.on(".vs-style","touchstart",function(n){n.preventDefault()}),e.addEventListener("touchmove",function(n){n.preventDefault()},!1),y?(touch.on("#win-btn","touchstart",function(n){f=n.touches[0].clientX,r()}),touch.on("#win-btn","touchmove",function(n){var t=n.touches[0].clientX;j(t)})):(T.onmouseenter=function(n){f=n.clientX,r()},T.onmousemove=function(n){var t=n.clientX;j(t)});var j=function(n){if(h){if(!p){var t="请先开始游戏!";return noticeSetTimeoutPublick(t)}n>f?(I.setAttribute("style","text-align:right"),m=2,C.show()):n<f&&(I.setAttribute("style","text-align:left"),m=1,C.show()),h=!1,f=n}};S.on("click",l),A.on("click",function(){C.hide(),I.setAttribute("style","text-align:center")}),b.on("click",function(){v.removeClass("hidden-style")}),n("#show-kilo-list>ul>li").on("click",function(){var t,e=n(this),i=e.attr("id");v.addClass("hidden-style"),n(".active").removeClass("active"),e.addClass("active"),t=e.html(),b.html(t),x=i}),k.on("click",function(){X.show()}),w.on("click",function(){return X.hide(),x?void u():noticeSetTimeoutPublick("请你先选择体重级别,才能开始比赛")}),_.on("click",function(){X.hide()});var E=function(){i()};return{doInit:E}}(Zepto,window,document);$(function(){controller.doInit()});