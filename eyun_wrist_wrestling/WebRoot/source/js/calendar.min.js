var controller=function(t,e,n){function i(){v=localStorage.getItem("s_id"),y=oGetVars.systime||(new Date).getTime(),w=new Date(y),g=w.Format("yyyy-MM")+"-01",m=new Date(g),h=Number(w.Format("d"))-1,f=w.getMonth()+1,o(m)}function o(t){var e=new Date(t),n=e.getMonth()+1,i=e.getTime(),o=e.getDay(),l=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();D.textContent=e.Format("yyyy年M月"),a(o,i,l,n,e)}function a(t,e,n,i,o){var a,c,r,s,u,d="",y=n,g=0,m=o.Format("yyyy-MM")+"-";if(t>=1)do c=new Date(a).Format("d"),d+=" <li ></li>";while(--t>0);do a=e+g*p,c=new Date(a).Format("d"),r=h==g&&i==f?'style="border:1px solid #B3B3B3"':"",s=h>g&&i==f,s?d+=' <li class="backDay" >'+c+"</li>":(u=m+c,d+=" <li id="+u+' class="select" '+r+">"+c+"</li>");while(++g<y);M.html(d),l()}function l(){var t=new Date(m).Format("yyyy-MM-dd"),e={s_id:v,date:t,flag:0},n="shop/getAppointmentInfoByDate.do",i=new PublickFn(n,e,c);i.ajaxFn(),i=null}function c(e){var n,i=e.date,o=i.length,a=A.length,l=0,c=0;if(o>0)do n="#"+i[c],t(n).attr("class","active");while(++c<o);if(a>0)do n="#"+A[l],console.log(n),t(n).attr("class","isActive");while(++l<o);var u=t(".select"),d=t(".active"),h=t(".isActive");u.on("click",r),d.on("click",s),h.on("click",r)}function r(){var t=this.id,e=this.getAttribute("class");"isActive"==e?(this.setAttribute("class",""),A.remove(t)):(this.setAttribute("class","isActive"),A.push(t))}function s(){var t=this.id;locationSelf.href="referee-design-game.html?nowTime="+t}function u(){var t=A.join(",");if(console.log(t,A),!(A.length>0))return noticeSetTimeoutPublick("请选择添加日期");var e={s_id:v,date:t},n="game/addAppointmentDate.do",i=new PublickFn(n,e,d);i.ajaxFn(),i=null}function d(t){noticeSetTimeoutPublick("成功添加日期"),A=[],i(),console.log(1)}var h,f,y,g,m,v,w,p=864e5,D=n.getElementById("todayTime"),M=t("#content-calendar"),F=t("#addGameDay"),A=[];Array.prototype.remove=function(t){var e=this.indexOf(t);e>-1&&this.splice(e,1)},Array.prototype.indexOf=function(t){for(var e=0,n=this.length;e<n;e++)if(this[e]==t)return e;return-1},F.on("click",u),touch.on(e,"swiperight",function(t){var e=new Date(g);e<m&&m.setMonth(m.getMonth()-1),o(m)}),touch.on(e,"swipeleft",function(t){m.setMonth(m.getMonth()+1),o(m)});var b=function(){i()};return{doInit:b}}(Zepto,window,document);$(function(){controller.doInit()});